#!@BASH_PATH@

# Initialization
option=
cflags=
libs=
data=
doc=
cflags_text="-I@prefix@/include"
libs_text="@prefix@/lib/libotawa.la"

# Decode options
while test "$1" != ""; do
	case "$1" in
	--cflags)
		cflags=ok
		option=ok
		;;
	--libs)
		libs=ok
		option=ok
		;;
	--data)
		data=ok
		option=ok
		;;
	--doc)
		doc=ok
		;;
	--has-so)
		exit @HAS_SO@
		;;
	gensim|+gensim)
		libs_text="@prefix@/lib/libogensim.la $libs_text"
		;;
	display|+display)
		libs_text="@prefix@/lib/libodisplay.la $libs_text"
		;;
	ppc)
		@HAS_PLUGIN_FALSE@ libs_text="-uppc_plugin @prefix@/lib/otawa/loader/ppc.la $libs_text"
		;;
	lp_solve)
		@HAS_PLUGIN_FALSE@ libs_text="-ulp_solve_plugin @prefix@/lib/otawa/ilp/lp_solve.la $libs_text"
		;;
	+ppc)
		libs_text="-uppc_plugin @prefix@/lib/otawa/loader/ppc.la $libs_text"
		;;
	+lp_solve)
		libs_text="-ulp_solve_plugin @prefix@/lib/otawa/ilp/lp_solve.la $libs_text"
		;;
	--version)
		echo "@PACKAGE@ @VERSION@"
		exit 1
		;;
	*)
		echo "ERROR: unknown option '$1'."
		exit 1
		;;
	esac
	shift
done

# Check options
if test "$option" == ""; then
	echo "SYNTAX: otawa-config [--cflags] [--libs] [--data] [+]modules..."
	echo "	--cflags: display required compilation flags."
	echo "	--libs: display required libs."
	echo "	--data: display path to package data."
	echo "  --doc: display path to the auto-documentation."
	echo "	--has-so: exit 0 if OTAWA is s shared object, false else."
	echo "  +module: Link module statically, even if we have plugins."
	echo "Modules may be:"
	echo "	gensim: use of the generic simulator."
	echo "	display: use of the graph displayer."
	echo "	ppc: static link with PowerPC loader."
	echo "	lp_solve: static link with lp_solve ILP solver."
	exit
fi

# Perform display
if test "$cflags" == "ok"; then
	echo $cflags_text
fi
if test "$libs" == "ok"; then
	echo $libs_text
fi
if test "$data" == "ok"; then
	echo @prefix@/share/Otawa
fi
if test "$doc" == "ok"; then
	echo @prefix@/share/Otawa/autodoc/index.html
fi
